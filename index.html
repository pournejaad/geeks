<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="main.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="container">
      <div class="box moving-box" id="guess"></div>
      <div class="box box-tl"></div>
      <div class="box box-tr"></div>
      <div class="box box-br"></div>
      <div class="box box-bl"></div>
    </div>
    <button type="button" class="btn" id="btn">click</button>
    <div class="information">
      <div class="info" id="x-coor">x-coordinate:</div>
      <div class="info" id="y-coor">y-coordiante:</div>
      <div class="info" id="dist">Dist:</div>
    </div>
    <script src="jquery-3.6.0.js"></script>
    <script src="jquery-ui.js"></script>

    <script>
      const threshold = 20;
      const fadingTimeMS = 3000;
      $(document).ready(function () {
        let start = {};
        let end = {};

        $("#guess").draggable({
          start: function (e, ui) {
            start = { left: e.target.offsetLeft, top: e.target.offsetTop };
            console.log(start);
          },
          drag: function (e, ui) {
            let current = {
              left: e.target.offsetLeft,
              top: e.target.offsetTop,
            };
            console.log(current);
            // $("#guess").animate(
            //   {
            //     right: 0,
            //     bottom: 0,
            //   },
            //   5000
            // );
            // if (movedRight(current.left, start.left)) {
            //   if (movedDown(current.top, start.top)) {
            //     if (distance(current, start) > 20) {
            //     }
            //   } else {
            //     $(this).animate(
            //       {
            //         left: $(".box-tr")[0].offsetLeft,
            //         top: $(".box-tr")[0].offsetTop,
            //         opacity: "0",
            //       },
            //       fadingTimeMS
            //     );
            //   }
            // }
            if (goToBottomRight(current, start)) {
              console.log("go to br");
              $(this).animate(
                {
                  left: $(".box-br")[0].offsetLeft,
                  top: $(".box-br")[0].offsetTop,
                  opacity: "0",
                },
                fadingTimeMS
              );
            } else if (goToTopRight(current, start)) {
              console.log("go to tr");
              $(this).animate(
                {
                  left: $(".box-tr")[0].offsetLeft,
                  top: $(".box-tr")[0].offsetTop,
                },
                fadingTimeMS
              );
            } else if (goToTopLeft(current, start)) {
              console.log("go to tl");
              $(this).animate(
                {
                  left: $(".box-tl")[0].offsetLeft,
                  top: $(".box-tl")[0].offsetTop,
                },
                fadingTimeMS
              );
            } else if (goToBottomLeft(current, start)) {
              console.log("go to bl");
              $(this).animate(
                {
                  left: $(".box-bl")[0].offsetLeft,
                  top: $(".box-bl")[0].offsetTop,
                },
                fadingTimeMS
              );
            }

            $("#x-coor").text(`x-coordinate: ${e.target.offsetLeft}`);
            $("#y-coor").text(`y-coordinate: ${e.target.offsetTop}`);
          },
          stop: function (e, ui) {
            console.log("animate");
          },
        });

        $("#btn").click(function () {
          let windowHeight = $(window).height();
          console.log(windowHeight);
          let boxHeight = $("#box").height();
          console.log(boxHeight);
          let desiredBottom = 400;

          let newPos = windowHeight - (boxHeight + desiredBottom);
          console.log(newPos);
          $("#box").animate({ top: newPos }, 5000, function () {
            $("#box").css({ top: "100px" });
          });
        });
      });
      function distance(end, start) {
        let y = Math.pow(end.top - start.top, 2);
        let x = Math.pow(end.left - start.left, 2);
        return Math.sqrt(x + y);
      }
      function movedRight(end, start) {
        return end.left - start.left > 0;
      }
      function movedDown(end, start) {
        return end.top - start.top > 0;
      }
      function goToBottomRight(end, start) {
        return (
          movedDown(end.top, start.top) &&
          movedRight(end.left, start.left) &&
          distance(end, start) > threshold
        );
      }
      function goToTopRight(end, start) {
        return (
          !movedDown(end.top, start.top) &&
          movedRight(end.left, start.left) &&
          distance(end, start) > threshold
        );
      }
      function goToTopLeft(end, start) {
        return (
          !movedDown(end.top, start.top) &&
          !movedRight(end.left, start.left) &&
          distance(end, start) > threshold
        );
      }
      function goToBottomLeft(end, start) {
        return (
          movedDown(end.top, start.top) &&
          !movedRight(end.left, start.left) &&
          distance(end, start) > threshold
        );
      }
    </script>
  </body>
</html>
